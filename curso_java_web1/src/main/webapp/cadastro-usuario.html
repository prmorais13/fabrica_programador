<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Cadastro usuário</title>

    <script>
        usuarioController = function () {
            this.usuarios = [];

            // Create
            this.adicionar = function (usuario) {
                this.usuarios.push(usuario);
            }

            // Retrieve
            this.listarTodos = function () {
                return this.usuarios;
            }

            // Update
            this.alterar = function (indice, usuario) {
                //usuarioEncontrado = this.buscarPorIndice(indice);
                this.usuarios.splice(indice, 1, usuario);
            }

            // Delete
            this.excluir = function (indice) {
                this.usuarios.splice(indice, 1);
            }

            this.modoEdicao = false;

            // Renderiza o DOM
            this.renderizarTabelaUsuarios = function (arrUsuarios) {
                dados = "";

                for (i = 0; i < arrUsuarios.length; i++) {
                    dados += "<tr>";
                    dados += "<td>" + arrUsuarios[i].nome + "</td>";
                    dados += "<td>" + arrUsuarios[i].senha + "</td>";
                    dados += "<td><input type='button' value='Excluir' onclick='uc.aoClicarExcluir(" + i + ")'>";
                    dados += "<input type='button' value='Editar' onclick='uc.aoClicarEditar(" + i + ")'></td>";
                    dados += "</tr>"
                }
                document.getElementById('tbUsuarios').innerHTML = dados;

            }

            this.limparCampos = function () {
                this.modoEdicao = false;
                document.getElementById('txtUsuario').value = "";
                document.getElementById('txtSenha').value = "";
            }

            this.buscarPorIndice = function (indice) {
                return this.usuarios[indice];
            }

            // Eventos dos botões
            this.aoClicarListar = function () {
                usuarios = this.listarTodos();
                this.renderizarTabelaUsuarios(usuarios);
            }

            this.aoClicarExcluir = function (indice) {
                this.excluir(indice);
                this.aoClicarListar();
            }

            this.aoClicarEditar = function (indice) {
                this.modoEdicao = true;
                this.indiceEdicao = indice;
                usuarioEncontrado = this.buscarPorIndice(indice);
                document.getElementById('txtUsuario').value = usuarioEncontrado.nome;
                document.getElementById('txtSenha').value = usuarioEncontrado.senha;
            }

            this.aoClicarCancelar = function () {
                this.limparCampos();
            }

            this.aoClicarSalvar = function () {
                //Leitura dos dados
                nomeUsuario = document.getElementById('txtUsuario').value;
                senhaUsuario = document.getElementById('txtSenha').value;

                // Constroi objeto usuario
                usu = { nome: nomeUsuario, senha: senhaUsuario };

                // Adicionar ao vetor
                if (this.modoEdicao) {
                    this.alterar(this.indiceEdicao, usu);
                } else {
                    this.adicionar(usu);
                }

                this.aoClicarListar();
                this.limparCampos();
            }


        }

        uc = new usuarioController();

    </script>
</head>

<body>
    <form method="post">
        <input id="txtUsuario" type="text" placeholder="Nome usuário">
        <input id="txtSenha" type="password" placeholder="Senha">

        <input type="button" value="Salvar" onclick="uc.aoClicarSalvar()">
        <input type="button" value="Cancelar" onclick="uc.aoClicarCancelar()">
    </form>
    <br>
    <table border="1">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Senha</th>
                <th>Opções</th>
            </tr>
        </thead>

        <tbody id="tbUsuarios"></tbody>
    </table>
</body>

<script>

</script>

</html>